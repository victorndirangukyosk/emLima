(function(){var f="object"===typeof JSON&&"function"===typeof JSON.stringify?JSON.stringify:function(){function a(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var b=e[a];return"string"===typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function b(d,e){var g,k,u=c,n,l=e[d];switch(typeof l){case "string":return a(l);case "number":return isFinite(l)?String(l):"null";case "boolean":case "null":return String(l);case "object":if(!l)return"null";c+="";n=[];if("[object Array]"===
Object.prototype.toString.apply(l)){k=l.length;for(g=0;g<k;g+=1)n[g]=b(g,l)||"null";k=0===n.length?"[]":c?"[\n"+c+n.join(",\n"+c)+"\n"+u+"]":"["+n.join(",")+"]";c=u;return k}for(g in l)Object.prototype.hasOwnProperty.call(l,g)&&(k=b(g,l))&&n.push(a(g)+(c?": ":":")+k);k=0===n.length?"{}":c?"{\n"+c+n.join(",\n"+c)+"\n"+u+"}":"{"+n.join(",")+"}";c=u;return k}}var c="",d=/[\\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(a){return b("",{"":a})}}(),m=/^(T|P)\w{10}$/,p=/^[A-Fa-f0-9]{64}$/;function q(a,b){if(null!==a)if(a.length===+a.length)for(var c=0,d=a.length;c<d&&b.call(void 0,a[c],c,a)!=={};c++);else for(c in a)if(a.hasOwnProperty(c)&&b.call(void 0,a[c],c,a)==={})break}function r(a){return"[object Array]"===Object.prototype.toString.apply(a)}
function t(){for(var a=!1,b=[function(){var a=!1;Function("/*@cc_on return /^10/.test(@_jscript_version) @*/")()&&(a=!0);if(a)throw 1;a=new XDomainRequest;v=!0;return a},function(){var a=new XMLHttpRequest;w=!0;return a}],c=0;c<b.length;c++){try{a=b[c]()}catch(d){continue}break}return a}var v=!1,w=!1;
function x(a,b){var c=t();c&&(c.open("POST","https://api.konduto.com/js/orders",!0),"object"===typeof a&&(w?q(a,function(a,b){c.setRequestHeader(b,a)}):v&&"object"===typeof b&&(b.headers=a)),"object"===typeof b&&(b=f(b)),c.send(b))}function y(a){this.d=a}y.prototype.g=function(){return!1};function z(a,b,c,d){this.d=a;this.i=b;this.maxLength=c;this.pattern=d;this.b=a}z.prototype=new y;z.prototype.f=function(a){return"number"===typeof a||"string"===typeof a?String(a):void 0};
z.prototype.g=function(a){var b=!0;a=this.f(a);if("string"!==typeof a)return this.message="Value needs to be string",!1;var c=a.length;"number"===typeof this.i&&(this.message=(b=c>=this.i)?null:"Length needs to be at minimum "+this.i);b&&"number"===typeof this.maxLength&&(this.message=(b=c<=this.maxLength)?null:"Length needs to be at maximum "+this.maxLength);b&&this.pattern instanceof RegExp&&(this.message=(b=!!a.match(this.pattern))?null:"Input does not match pattern: "+this.pattern);return b};
function A(a,b,c,d,e){this.b=this.d=a;this.e=b;this.c=c;this.o=!!d;this.n=!!e;this.b=this.d?this.d:""}A.prototype=new y;A.prototype.f=function(a){return"number"===typeof a||"string"===typeof a?Number(a):void 0};
A.prototype.g=function(a){a=this.f(a);if("number"!==typeof a)return this.message="Value needs to be a valid number or integer",!1;var b=!0;"number"===typeof this.e&&(this.message=this.o?(b=a>this.e)?null:"Value needs to be bigger than "+this.e:(b=a>=this.e)?null:"Value needs to be bigger than or equal to "+this.e);b&&"number"===typeof this.c&&(this.message=this.n?(b=a<this.c)?null:"Value needs to be smaller than "+this.c:(b=a<=this.c)?null:"Value needs to be smaller than or equal to "+this.c);return b};
function B(a,b,c,d,e){this.d=a;this.e=b;this.c=c;this.o=!!d;this.n=!!e;this.b=a}B.prototype=new A;B.prototype.f=function(a){return"string"!==typeof a&&"number"!==typeof a||0!==a%1?void 0:parseInt(a)};function C(a){this.b=this.d=a}C.prototype=new y;C.prototype.g=function(a){return"boolean"!==typeof a?(this.message="Value needs to be boolean",!1):!0};
function D(a,b,c,d){this.d=a;var e={};r(b)&&q(b,function(a){a instanceof y&&(e[a.d]=a)});this.a=e;this.required=r(c)?c:[];this.h="boolean"===typeof d?d:!0}D.prototype=new y;D.prototype.f=function(a){if("object"===typeof a){var b=this;q(a,function(c,d){b.a.hasOwnProperty(d)&&"function"===typeof b.a[d].f&&(a[d]=b.a[d].f(a[d]))});return a}};
D.prototype.g=function(a){var b=!0,c=this;this.b=this.d?this.d:"";if("object"!==typeof a)return this.message="Value needs to be an object",!1;q(this.required,function(d){b&&!a.hasOwnProperty(d)&&(b=!1,c.message="Missing required field: "+d)});q(a,function(a,e){!b||c.h||c.a.hasOwnProperty(e)?b&&c.a.hasOwnProperty(e)&&!c.a[e].g(a)&&(b=!1,c.message=c.a[e].message,"string"===typeof c.a[e].b&&(c.b+="/"+c.a[e].b)):(b=!1,c.message="Additional property not allowed: "+e)});return b};
function E(a,b,c,d){this.d=a;this.j=b instanceof y?b:null;this.l="number"===typeof c?c:null;this.q="number"===typeof d?d:0}E.prototype=new y;E.prototype.f=function(a){if(r(a)){var b=this,c=[];"function"===typeof b.j.f?q(a,function(a){a=b.j.f(a);"undefined"!==typeof a&&c.push(a)}):c=a;return c}};
E.prototype.g=function(a){var b=!0,c=this;this.b=this.d?this.d:"";if(!r(a))return this.message="Value needs to be an array",!1;if("number"===typeof this.l&&a.length>this.l||a.length<this.q)return this.message="The number of objects in this array should be between "+this.q+" and "+this.l,!1;q(a,function(a,e){c.j.g(a)||(b=!1,c.message=c.j.message,"string"===typeof c.j.b&&(c.b+="/"+e+"/"+c.j.b))});return b};function F(a){this.root=G(a,"object"===typeof a?a.title:void 0)}
function G(a,b){if("object"!==typeof a)throw TypeError("Invalid schema definition");switch(a.type){case "s":return new z(b,a.i,a.maxLength,a.pattern);case "f":return new A(b,a.e,a.c,a.o,a.n);case "i":return new B(b,a.e,a.c,a.o,a.n);case "a":return new E(b,G(a.items),a.l,a.q);case "b":return new C(b);case "o":var c=[];q(a.a,function(a,b){var h=G(a,b);c.push(h)});return new D(b,c,a.required,a.h);default:throw TypeError("Invalid schema definition");}}
function H(a,b){var c=I.prototype.r,d=c.root instanceof D,e=d,h=null;if(d&&!(a in c.root.a)&&!c.root.h)throw new J("Property '"+a+"' not allowed");d&&a in c.root.a&&(h=c.root.a[a],e=h.g(b),h="function"===typeof h.f?h.f(b):b);if(!e)throw new J(d?c.root.a[a]:"Schema root is not an object");return h}F.prototype.g=function(a){a=this.root instanceof y?this.root.g(a):!1;if(!a)throw new J(this.root);return a};
function J(a){this.name="ValidationError";var b=[this.name];a instanceof y?("string"===typeof a.b&&(this.b=a.b,b.push("Where: /"+this.b)),"string"===typeof a.message&&(this.reason=a.message,b.push("Reason: "+this.reason))):"string"===typeof a&&b.push(a);this.message=b.join(" - ")}
var K={type:"o",h:!1,a:{name:{type:"s",maxLength:100},address1:{type:"s",maxLength:255},address2:{type:"s",maxLength:255},city:{type:"s",maxLength:100},state:{type:"s",maxLength:100},zip:{type:"s",maxLength:100},country:{type:"s",i:2,maxLength:2}}};function I(){}
I.prototype={r:new F({title:"order",type:"o",h:!1,required:["id","total_amount","customer"],a:{id:{type:"s",maxLength:100},visitor:{type:"s",i:0,maxLength:255},total_amount:{type:"f",e:0,c:9E7},shipping_amount:{type:"f",e:0,c:9E7},tax_amount:{type:"f",e:0,c:9E7},installments:{type:"i",e:1,c:999},currency:{type:"s",pattern:/^[A-Z]{3}$/},ip:{type:"s",pattern:/^(\d{1,3}\.){3}\d{1,3}$/},analyze:{type:"b"},customer:{type:"o",h:!1,required:["id","name","email"],a:{id:{type:"s",maxLength:100},name:{type:"s",
maxLength:100},email:{type:"s",maxLength:100},tax_id:{type:"s",maxLength:100},phone1:{type:"s",maxLength:100},phone2:{type:"s",maxLength:100},"new":{type:"b"},vip:{type:"b"},dob:{type:"s",pattern:/^\d{4}-\d{2}-\d{2}$/}}},payment:{type:"a",l:5,items:{type:"o",h:!1,required:["type","status"],a:{type:{type:"s",pattern:/^(credit|boleto)$/},status:{type:"s",pattern:/^(approved|declined|pending)$/},expiration_date:{type:"s",pattern:/^(\d{6}|\d{4}-\d{2}-\d{2})$/},bin:{type:"s",i:6,maxLength:6,pattern:/^\d+$/},
last4:{type:"s",i:4,maxLength:4,pattern:/^\d+$/}}}},billing:K,shipping:K,shopping_cart:{type:"a",items:{type:"o",h:!1,a:{sku:{type:"s",maxLength:100},product_code:{type:"s",maxLength:100},category:{type:"i",e:100,c:9999},name:{type:"s",maxLength:100},description:{type:"s",maxLength:100},unit_cost:{type:"f",c:9E7},quantity:{type:"f",c:9E7},discount:{type:"f",c:9E7}}}}}}),set:function(a,b){if("string"===typeof a)try{b=H(a,b)}catch(c){I.prototype.error=c.message;if(L)throw c;return!1}finally{this[a]=
b}else if("object"===typeof a){var d=this;q(a,function(a,b){d.set(b,a)})}return!0},isValid:function(){try{return I.prototype.r.g(this),I.prototype.error="",!0}catch(a){return I.prototype.error=a.message,!1}},error:""};function N(){this.buffer=[]}N.prototype.append=function(a){this.buffer.push(a);return this};N.prototype.toString=function(){return this.buffer.join("")};function O(a){this.p=a;this.k=-1;this.m=[]}O.prototype={current:Number.NaN};
function P(a){if(0<a.m.length)return a.current=a.m.shift(),!0;if(a.k>=a.p.length-1)return a.current=Number.NaN,!1;var b=a.p.charCodeAt(++a.k);13==b&&10==a.p.charCodeAt(a.k+1)&&(b=10,a.k+=2);128>b?a.current=b:(127<b&&2048>b?a.current=b>>6|192:(a.current=b>>12|224,a.m.push(b>>6&63|128)),a.m.push(b&63|128));return!0}var L=!0,Q=window.Konduto?window.Konduto:new Function;Q.version="1.1.0";Q.setPublicKey=function(a){if("string"!==typeof a||a.match(m))return Q.key=a,!0;R("Invalid public api key - A public key must contain 11 letters or digits and must start with 'T' or 'P'")};
Q.setSignature=function(a){if("string"!==typeof a||a.match(p))return Q.signature=a,!0;R("Signature is not a valid SHA256 hash string")};Q.order=new I;Q.validateOrder=function(){var a=Q.order,b=a instanceof I,c=b?a:new I;b||"object"!==typeof a||c.set(a);Q.order=c;a=Q.order.isValid();Q.error=Q.order.error;return a};Q.error="";Q.disableExceptions=function(a){L="boolean"===typeof a?!a:!1};
Q.post=function(){if(!Q.signature||!Q.key)return R("Public key and signature must be set"),!1;for(var a=f(Q.order),b=new N,c=new O(Q.key);P(c);){var d=c.current;P(c);var e=c.current;P(c);var h=c.current,M=d>>2,d=(d&3)<<4|e>>4,g=(e&15)<<2|h>>6,k=h&63;isNaN(e)?g=k=64:isNaN(h)&&(k=64);b.append("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(M)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(k))}x({"Content-type":"application/json",Authorization:"Basic "+b.toString(),"Xkdt-HMAC":"sha256 "+Q.signature},a);return!0};function R(a){Q.error=a;if(L)throw Q.error;}window.Konduto=Q;;})();